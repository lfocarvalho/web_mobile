{% extends "base.html" %}
{% block titulo %}Meu Carrinho{% endblock %}

{% block conteudo %}
<main class="flex flex-1 justify-center py-10">
    <div class="w-full max-w-4xl px-4">
        <h1 class="mb-8 text-4xl font-bold text-neutral-800 dark:text-white">Carrinho de Compras</h1>
        <div class="grid grid-cols-1 gap-8 lg:grid-cols-3">
            <div class="space-y-4 lg:col-span-2">
                {% if carrinho and carrinho.itens.all %}
                    {% for item in carrinho.itens.all %}
                    <div class="rounded-xl border border-neutral-200 bg-white p-4 shadow-sm dark:border-neutral-800 dark:bg-neutral-900/50">
                        <div class="flex items-center justify-between gap-4">
                            <div class="flex items-center gap-4">
                                {% if item.produto.imagem %}
                                <div class="h-16 w-16 flex-shrink-0 rounded-lg bg-cover bg-center bg-no-repeat"
                                    style='background-image: url("{{ item.produto.imagem.url }}");'>
                                </div>
                                {% endif %}
                                <div>
                                    <p class="font-medium text-neutral-800 dark:text-white">{{ item.produto.nome }}</p>
                                    <p class="text-sm text-neutral-500 dark:text-neutral-400">Preço: R$ {{ item.preco }}</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <span class="w-10 border-0 bg-transparent p-0 text-center text-neutral-800 focus:ring-0 dark:text-white">
                                    {{ item.quantidade }}x
                                </span>
                                <a href="{% url 'pedido:remover_do_carrinho' item.id %}"
                                    class="flex h-8 w-8 items-center justify-center rounded-full bg-red-100 text-red-600 transition-colors hover:bg-red-200">
                                    <span class="material-symbols-outlined">delete</span>
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <p>Seu carrinho está vazio.</p>
                {% endif %}
            </div>

            ...
            {% if carrinho and carrinho.itens.all %}
            <div class="lg:col-span-1">
                <div class="rounded-xl border border-neutral-200 bg-white p-6 shadow-sm dark:border-neutral-800 dark:bg-neutral-900/50">
                    <h3 class="mb-4 text-lg font-bold text-neutral-800 dark:text-white">Resumo do Pedido</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between text-sm">
                            <p class="text-neutral-500 dark:text-neutral-400">Subtotal</p>
                            <p class="font-medium text-neutral-800 dark:text-white">R$ {{ subtotal|floatformat:2 }}</p>
                        </div>
                        <div class="flex justify-between text-sm">
                            <p class="text-neutral-500 dark:text-neutral-400">Frete</p>
                            <p class="font-medium text-neutral-800 dark:text-white">R$ 5.00</p>
                        </div>
                    </div>
                    <div class="my-4 border-t border-dashed border-neutral-200 dark:border-neutral-800"></div>
                    <div class="flex justify-between">
                        <p class="font-bold text-neutral-800 dark:text-white">Total</p>
                        <p class="font-bold text-neutral-800 dark:text-white">R$ {{ subtotal|add:5|floatformat:2 }}</p>
                    </div>
                    <a href="{% url 'pedido:finalizar_pedido' %}"
                        class="mt-6 block w-full rounded-lg bg-primary py-3 text-center font-bold text-black transition-transform hover:scale-[1.02]">
                        Finalizar Compra
                    </a>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</main>
{% endblock %}